<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Create Model Item</title>
    <link rel="icon" type="image/x-icon" href="../static/img/logo/favicon.ico">

    <script src="../static/js/common/vue.min.js"></script>
    <script src="../static/js/common/vue-avatar.min.js"></script>

    <link rel="stylesheet" type="text/css" media="screen"
          href="../static/css/font-awesome/css/font-awesome.min.css"
    />
    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/page/create-modelitem.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/other/jquery-steps.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/other/jquery.tag-editor.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/other/modelItemEditor.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/base/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/base/style.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/element-ui/theme-chalk/index.css"/>
    <link rel="stylesheet" href="../static/css/base/universal.css">
    <link rel="stylesheet" href="../static/css/base/list.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../static/css/other/bootstrap-select.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/data-tables/DT_bootstrap.css"/>

    <style>
        .btn-block {
            padding: 6px 12px;
        }

        tbody tr td {
            word-wrap: break-word;
            word-break: break-all;
            overflow: hidden;
        }
    </style>
    <style>
        .searcherPanel .searcherInputPanel {
            display: inline-flex;
            width: 100%;
        }

        .searcherPanel .searcherInputPanel input {
            font-size: 14px;
            line-height: 28px;
            display: block;
            box-sizing: border-box;
            width: 100%;
            height: 40px;
            padding: 5px 10px;
            color: #999;
            border: 1px solid #2277da;
        }

        .searcherPanel .searcherInputPanel button {
            background: #008af1;
            border: none;
            height: 40px;
            color: #fff;
            text-align: center;
            width: 92px;
            font-size: 14px;
            cursor: pointer;
            vertical-align: middle;
        }

        .searcherPanel .searcherInputPanel button:hover,
        .searcherPanel .searcherInputPanel button:active {
            background: #0070cc;
        }

        .searcherPanel .fa-angle-double-down {
            padding: 0px 5px;
            color: #1989FA;
        }

        .searcherPanel .fa-angle-double-down:hover {
            color: #0070cc;
        }

        .progressPanel .barControl {
            width: 30%;
            margin: 0 auto;
        }

        .progressPanel .barControl .barContro_space {
            border-radius: 5px;
        }

        .progressPanel .barControl .barContro_space .progress_line {
            height: 3px;
            width: 0%;
            border-radius: 2px;
            background: #008af1;
            display: block;
        }

        .progressPanel .barControl .barContro_space .progress_line.active {
            -webkit-animation: progressbar 0.75s;
            animation: progressbar 0.75s;
            animation-fill-mode: forwards;
        }

        /* Chrome, Safari, Opera */
        @-webkit-keyframes progressbar {
            from {
                width: 0
            }
            to {
                width: 80%
            }
        }

        /* Standard syntax */
        @keyframes progressbar {
            from {
                width: 0
            }
            to {
                width: 80%
            }
        }


    </style>
</head>

<body class="scrollbar">
<div id="app">
    <div id="loading" v-if="load">
        <div class="loading-center">
            <div class="loading-center-absolute">
                <div class="object"></div>
            </div>
        </div>
    </div>
    <div class="page-container">

        <div th:replace="fragments/sidebar :: side"></div>

        <div class="page-content clearfix scrollbar"
             :style="{'min-height':ScreenMaxHeight,'max-height':ScreenMaxHeight}" style="overflow-x: hidden;">

            <div th:replace="fragments/sidebar :: top1"></div>

            <div class="page-content-wrap container-fluid">
                <!-- START WIDGETS -->
                <div class="row">

                </div>
                <!-- END WIDGETS -->

                <div class="row">
                    <div class="container-fluid" id="mainInfo">
                        <div class="row">
                            <div class="col-md-12 nopadding">
                                <div class="panel panel-success" style="border: none">
                                    <div class="panel-body">
                                        <div id="step">
                                            <div class="step-app">
                                                <ul class="step-steps text-center">
                                                    <li>
                                                        <a href="#step1">Basic Info</a>
                                                    </li>
                                                    <li>
                                                        <a href="#step2">Content</a>
                                                    </li>
                                                    <li>
                                                        <a href="#step3">Authorship</a>
                                                    </li>
                                                    <li>
                                                        <a href="#step4">Relate</a>
                                                    </li>

                                                </ul>
                                                <div class="step-content">
                                                    <div class="step-tab-panel" id="step1">
                                                        <div class="col-sm-4 tree" style="margin-top:10px">
                                                            <el-card>
                                                                <div slot="header" class="clearfix text-center">
                                                                    <span style="font-size: 20px;color:#444">Model Classifications</span>
                                                                </div>
                                                                <el-tree style="height: 320px;overflow: auto"
                                                                         id="tree1"
                                                                         ref="tree1"
                                                                         :data="treeData"
                                                                         show-checkbox
                                                                         node-key="id"
                                                                         :default-expanded-keys="[]"
                                                                         :current-node-key="100"
                                                                         @check-change="handleCheckChange"
                                                                         :props="defaultProps">
                                                                </el-tree>
                                                            </el-card>
                                                        </div>
                                                        <div class="col-sm-8">
                                                            <div id="RepositoryParentsPanel">
                                                                <div class="form-horizontal">
                                                                    <div class="form-group">
                                                                        <label for="parentNode"
                                                                               class="col-sm-2 control-label">Classifications</label>
                                                                        <div class="col-sm-10">
                                                                            <textarea class="form-control"
                                                                                      id="parentNode"
                                                                                      v-model="clsStr"
                                                                                      readonly></textarea>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="form-horizontal">
                                                                    <div class="form-group">
                                                                        <label for="nameInput"
                                                                               class="col-sm-2 control-label">Name</label>
                                                                        <div class="col-sm-10">
                                                                            <input type="text" class="form-control"
                                                                                   id="nameInput"/>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="form-horizontal">
                                                                    <div class="form-group">
                                                                        <label for="tagInput"
                                                                               class="col-sm-2 control-label">Keywords</label>
                                                                        <div class="col-sm-10">
                                                                            <textarea class="form-control"
                                                                                      id="tagInput"></textarea>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="form-horizontal">
                                                                    <div class="form-group">
                                                                        <label for="descInput"
                                                                               class="col-sm-2 control-label">Overview</label>
                                                                        <div class="col-sm-10">
                                                                            <textarea rows="4" class="form-control"
                                                                                      id="descInput"></textarea>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="form-horizontal">
                                                                    <div class="form-group">
                                                                        <label for="nameInput"
                                                                               class="col-sm-2 control-label">Image</label>
                                                                        <div class="col-sm-10">
                                                                            <img id="imgShow" src=""/>
                                                                            <div id="imgChange">
                                                                                <i class="fa fa-plus fa-5x"></i>
                                                                            </div>
                                                                            <input id="imgFile" type="file"
                                                                                   style="display: none"
                                                                                   accept="image/*"/>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="form-horizontal">
                                                                    <div class="form-group">
                                                                        <label for="parentNode"
                                                                               class="col-sm-2 control-label">References</label>
                                                                        <div class="col-sm-10">
                                                                            <table class="display table table-bordered table-striped dataTable"
                                                                                   id="dynamic-table"
                                                                                   aria-describedby="dynamic-table_info">
                                                                                <thead>
                                                                                <tr role="row">
                                                                                    <th class="sorting"
                                                                                        role="columnheader" tabindex="0"
                                                                                        aria-controls="dynamic-table"
                                                                                        rowspan="1" colspan="1"
                                                                                        aria-label="Title: activate to sort column ascending"
                                                                                        width="200px">
                                                                                        Title
                                                                                    </th>
                                                                                    <th class="sorting"
                                                                                        role="columnheader" tabindex="0"
                                                                                        aria-controls="dynamic-table"
                                                                                        rowspan="1" colspan="1"
                                                                                        aria-label="Author: activate to sort column ascending"
                                                                                        width="200px">
                                                                                        Author
                                                                                    </th>
                                                                                    <th class="sorting"
                                                                                        role="columnheader" tabindex="0"
                                                                                        aria-controls="dynamic-table"
                                                                                        rowspan="1" colspan="1"
                                                                                        aria-label="Date: activate to sort column ascending"
                                                                                        width="100px">
                                                                                        Date
                                                                                    </th>
                                                                                    <th class="hidden-phone sorting"
                                                                                        role="columnheader" tabindex="0"
                                                                                        aria-controls="dynamic-table"
                                                                                        rowspan="1" colspan="1"
                                                                                        aria-label="Journal: activate to sort column ascending"
                                                                                        width="100px">
                                                                                        Journal
                                                                                    </th>
                                                                                    <th class="hidden-phone sorting"
                                                                                        role="columnheader" tabindex="0"
                                                                                        aria-controls="dynamic-table"
                                                                                        rowspan="1" colspan="1"
                                                                                        aria-sort="descending"
                                                                                        aria-label="Pages: activate to sort column ascending"
                                                                                        width="100px">
                                                                                        Pages
                                                                                    </th>
                                                                                    <th class="hidden-phone sorting"
                                                                                        role="columnheader" tabindex="0"
                                                                                        aria-controls="dynamic-table"
                                                                                        rowspan="1" colspan="1"
                                                                                        aria-sort="descending"
                                                                                        aria-label="Links: activate to sort column ascending"
                                                                                        width="100px">
                                                                                        Links
                                                                                    </th>
                                                                                    <th class="hidden-phone sorting"
                                                                                        role="columnheader" tabindex="0"
                                                                                        aria-controls="dynamic-table"
                                                                                        rowspan="1" colspan="1"
                                                                                        aria-sort="descending"
                                                                                        aria-label="CSS grade: activate to sort column ascending"
                                                                                        width="82px">
                                                                                        Operation
                                                                                    </th>
                                                                                </tr>
                                                                                </thead>

                                                                                <tbody role="alert" aria-live="polite"
                                                                                       aria-relevant="all">

                                                                                </tbody>
                                                                            </table>
                                                                            <button id="addref"
                                                                                    class="btn btn-success btn-lg btn-block"
                                                                                    data-toggle="modal"
                                                                                    data-target="#refinfo"
                                                                                    type="button">Add Reference
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!--<div class="form-horizontal">-->
                                                                <!--<div class="form-group">-->
                                                                <!--<label for="parentNode"-->
                                                                <!--class="col-sm-2 control-label">Show On-->
                                                                <!--Index</label>-->
                                                                <!--<div class="col-sm-10">-->
                                                                <!--<div class="radioPanel">-->
                                                                <!--<input id="item1" type="radio"-->
                                                                <!--name="item" value=1>-->
                                                                <!--<label for="item1">-->
                                                                <!--<span>Yes</span>-->
                                                                <!--</label>-->
                                                                <!--</div>-->
                                                                <!--<div class="radioPanel">-->
                                                                <!--<input id="item2" type="radio"-->
                                                                <!--name="item" value=0 checked>-->
                                                                <!--<label for="item2">-->
                                                                <!--<span>No</span>-->
                                                                <!--</label>-->
                                                                <!--</div>-->
                                                                <!--</div>-->
                                                                <!--</div>-->
                                                                <!--</div>-->
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="step-tab-panel" id="step2">
                                                        <textarea id="myText"></textarea>
                                                    </div>
                                                    <div class="step-tab-panel" id="step3">
                                                        <div class="panel panel-success" style="border:none">

                                                            <div class="panel-body">
                                                                <div class="col-md-10 col-md-offset-1">

                                                                    <div class="panel-group " id="accordion2">
                                                                        <div id="providersPanel" class="panel"
                                                                             style="border-color:#424f63">
                                                                            <div class="panel-heading"
                                                                                 style="background-color: #424f63">
                                                                                <h4 class="panel-title"
                                                                                    style="color:white">
                                                                                    <a class="accordion-toggle"
                                                                                       data-parent="#accordion2">
                                                                                        Authorship
                                                                                    </a>
                                                                                </h4>
                                                                            </div>
                                                                            <div id="provider_body"
                                                                                 class="panel-collapse collapse in"
                                                                                 style="height: auto;">
                                                                                <div class="panel-body providers"
                                                                                     style="border-top: #424f63; padding:0px">
                                                                                    <div class='panel panel-primary'>
                                                                                        <div class='panel-heading info-head'>
                                                                                            <h4 class='panel-title'>
                                                                                                <a class='accordion-toggle collapsed'
                                                                                                   style="color:white"
                                                                                                   data-toggle='collapse'
                                                                                                   data-target='#user1'
                                                                                                   href="javascript:;">
                                                                                                    NEW
                                                                                                </a>
                                                                                            </h4>
                                                                                            <a href="javascript:;"
                                                                                               class="fa fa-times author_close"
                                                                                               style="float:right;margin-top:8px;color:white"></a>
                                                                                        </div>
                                                                                        <div id='user1'
                                                                                             class='panel-collapse collapse in'>
                                                                                            <div class='panel-body user-contents'>
                                                                                                <div class='user-attr'>
                                                                                                    <div>
                                                                                                        <lable class='control-label col-sm-2 text-center'
                                                                                                               style='font-weight: bold;'>
                                                                                                            Name:
                                                                                                        </lable>
                                                                                                        <div class='input-group col-sm-10'>
                                                                                                            <input type='text'
                                                                                                                   name="name"
                                                                                                                   class='form-control'>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div style="margin-top:10px">
                                                                                                        <lable class='control-label col-sm-2 text-center'
                                                                                                               style='font-weight: bold;'>
                                                                                                            Affiliation:
                                                                                                        </lable>
                                                                                                        <div class='input-group col-sm-10'>
                                                                                                            <input type='text'
                                                                                                                   name="ins"
                                                                                                                   class='form-control'>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div style="margin-top:10px">
                                                                                                        <lable class='control-label col-sm-2 text-center'
                                                                                                               style='font-weight: bold;'>
                                                                                                            Email:
                                                                                                        </lable>
                                                                                                        <div class='input-group col-sm-10'>
                                                                                                            <input type='text'
                                                                                                                   name="email"
                                                                                                                   class='form-control'>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div style="margin-top:10px">
                                                                                                        <lable class='control-label col-sm-2 text-center'
                                                                                                               style='font-weight: bold;'>
                                                                                                            Homepage:
                                                                                                        </lable>
                                                                                                        <div class='input-group col-sm-10'>
                                                                                                            <input type='text'
                                                                                                                   name="homepage"
                                                                                                                   class='form-control'>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <button type="button"
                                                                                        class="btn btn-success btn-lg btn-block user-add"
                                                                                        style="border-radius: 3px;border-top-left-radius: 0px;border-top-right-radius: 0px">
                                                                                    Add
                                                                                </button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="step-tab-panel" id="step4">
                                                        <el-card class="col-sm-2" style="padding:0px">
                                                            <div slot="header" class="clearfix text-center">
                                                                <span style="font-size: 20px;color:#444">Repository</span>
                                                            </div>
                                                            <el-tree
                                                                    id="tree2"
                                                                    ref="tree2"
                                                                    :data="repoData"
                                                                    node-key="id"
                                                                    :current-node-key="1"
                                                                    :highlight-current="true"
                                                                    :expand-on-click-node="true">
      <span class="custom-tree-node" slot-scope="{ node, data }">
        <span>{{ node.label }}</span>
        <span v-if="node.label !== 'Model Item' && node.label !== 'Data Item' && node.label !== 'Conceptual Model'
        && node.label !== 'Logical Model' && node.label !== 'Computable Model' && node.label !== 'Concept & Semantic'
        && node.label !== 'Spatial Reference' && node.label !== 'Data Template' && node.label !== 'Unit & Metric'">
          <!--<el-button-->
            <!--type="text"-->
            <!--size="mini"-->
            <!--@click="() => append(data)">-->
            <!--Append-->
            <!--</el-button>-->
          <el-button
                  type="text"
                  size="mini"
                  style="font-size: 25px;margin-top:-3px;display: inline-block;position:absolute;right:0px;padding:0px;background-color: white;"
                  @click="() => remove(node, data)">
            Ã—
          </el-button>
        </span>
      </span>
                                                            </el-tree>
                                                        </el-card>
                                                        <div class="col-sm-10" style="padding-right:0px">
                                                            <el-card class="col-sm-3" style="padding:0px">
                                                                <div slot="header" class="clearfix text-center">
                                                                    <span style="font-size: 20px;color:#444">Classification</span>
                                                                </div>
                                                                <el-tree
                                                                        id="tree3"
                                                                        ref="tree3"
                                                                        :data="classificationData"
                                                                        :highlight-current="true"
                                                                        :expand-on-click-node="false"
                                                                        node-key="id"
                                                                        :default-expanded-keys="[]"

                                                                        @current-change="handleCurrentChange"
                                                                        :props="defaultProps">
                                                                </el-tree>
                                                            </el-card>
                                                            <div class="col-sm-9" style="padding-right:0px">
                                                                <div class="searcherPanel">
                                                                    <div class="searcherInputPanel"
                                                                         @keydown.enter="search()">
                                                                        <input id="searchBox" type="text"
                                                                               placeholder="Model Item Name..."
                                                                               v-model="searchText">
                                                                        <button @click="search()"><i
                                                                                class="glyphicon glyphicon-search"></i>
                                                                            Search
                                                                        </button>

                                                                    </div>
                                                                </div>

                                                                <div class="progressPanel">
                        <span class="barControl">
                            <div class="barContro_space">
                                <span class="progress_line" :class="{active:pageOption.progressBar}"></span>
                            </div>
                        </span>
                                                                </div>

                                                                <div id="curClassBar" role="alert"
                                                                     class="alert alert-info"
                                                                     style="margin-bottom: 2px;"><span><strong>Current Classification: {{currentClass}} </strong>
                        <strong v-if="pageOption.progressBar" style="float: right;">Loading... </strong>
                        <strong v-if="!pageOption.progressBar" style="float: right;">{{pageOption.total}} items</strong></span><br>
                                                                    <span></span> <span></span>
                                                                </div>

                                                                <div class="modelPanel">
                                                                    <div class="content-body">
                                                                        <div v-cloak class="list-item"
                                                                             v-for="(modelItem,key) in pageOption.searchResult">
                                                                            <div class="detail_title">
                                                                                <a :class="modelItem.viewCount>500?'hot':''"
                                                                                   :href="'/modelItem/'+ modelItem.oid"
                                                                                   target="_blank">{{modelItem.name}}&nbsp&nbsp</a>
                                                                                <i class="fa fa-plus-square fa-2x pull-right"
                                                                                   style="color:deepskyblue;cursor:pointer;"></i>
                                                                                <i class="fa fa-minus-square fa-2x pull-right"
                                                                                   style="color:orangered;cursor:pointer;"></i>
                                                                            </div>
                                                                            <div class="detail_overview">
                                                                                <a class="img"
                                                                                   :href="'/modelItem/'+ modelItem.oid"
                                                                                   target="_blank">
                                                                                    <avatar v-if="modelItem.image==''"
                                                                                            :username="modelItem.name"
                                                                                            :size="90"
                                                                                            :rounded="false"></avatar>
                                                                                    <img v-if="modelItem.image!=''"
                                                                                         :src="modelItem.image"
                                                                                         style="width:90px;height: 90px;">

                                                                                </a>

                                                                                <div class="info">
                                                                                    <p>{{modelItem.description}}</p>
                                                                                    <div class="tags"
                                                                                         v-if="modelItem.keywords.length>0">
                                                                                        <span class="badge badge-info"
                                                                                              v-for="keyword in modelItem.keywords">{{keyword.toUpperCase()}}</span>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <hr>
                                                                            <div class="detail_bottom">
                                                                                <div style="display:inline-block;float: left;margin-top:-5px;">
                                                                                    <img :src="pageOption.users[key].image==''?'../static/img/icon/default.png':pageOption.users[key].image"
                                                                                         class="round_icon"
                                                                                         style="margin-top:-5px;width:30px;height: 30px;display: inline-block;">

                                                                                    <a :href="'/user/'+ pageOption.users[key].oid"
                                                                                       target="_blank"
                                                                                       style="display: inline-block;margin-left: 5px;">
                                                                                        <h4>
                                                                                            {{pageOption.users[key].name}}</h4>
                                                                                    </a>
                                                                                    <h4 style="display: inline-block;margin-left: 20px">
                                                                                        contributed at
                                                                                        {{modelItem.createTime.substring(0,10)}} </h4>
                                                                                </div>
                                                                                <div class="detail_option">


                                                                                    <a href="javascript:void(0)"
                                                                                       class="fa fa-eye"
                                                                                       aria-hidden="true"></a>&nbsp&nbsp{{modelItem.viewCount}}
                                                                                    <!--<a href="javascript:void(0)" class="fa fa-thumbs-o-up" aria-hidden="true"></a>&nbsp&nbsp{{modelItem.thumbsUpCount}}-->
                                                                                </div>
                                                                                <br>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                    <el-pagination
                                                                            style="text-align: center;margin-top:20px"
                                                                            v-if="pageOption.paginationShow"
                                                                            @current-change="handlePageChange"
                                                                            :current-page="pageOption.currentPage"
                                                                            layout="total, prev, pager, next, jumper"
                                                                            :total="pageOption.total">
                                                                    </el-pagination>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="step-footer text-right">
                                                <button class="btn btn-warning prev" data-direction="prev">
                                                    Previous
                                                </button>
                                                <button class="btn btn-primary next" data-direction="next">Next
                                                </button>
                                                <button class="btn btn-success finish" data-direction="finish">
                                                    Finish
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- /.panel -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<!-- æ¨¡æ€æ¡†ï¼ˆModalï¼‰ -->
<div class="modal fade" id="refinfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background: deepskyblue">
                <h4 class="modal-title" id="myModalLabel" style="color:aliceblue">
                    Reference Info
                </h4>
            </div>
            <div class="modal-body" style="font-size: 20px;overflow: hidden">
                <section class="panel">
                    <header class="panel-heading custom-tab ">
                        <ul class="nav nav-tabs">
                            <li class="active">
                                <a href="#manually" data-toggle="tab" style="font-size:14px;"><strong><em>Manually</em></strong>&nbsp;&nbsp;enter
                                    Reference</a>
                            </li>
                            <li class="">
                                <a href="#automatically" data-toggle="tab" style="font-size:14px;"><strong><em>Automatically</em></strong>&nbsp;&nbsp;enter
                                    Reference by DOI</a>
                            </li>
                        </ul>
                    </header>
                    <div class="panel-body">
                        <div class="tab-content">
                            <div class="tab-pane active" id="manually">
                                <div class="form-group">
                                    <label for="nameInput"
                                           class="col-sm-2 control-label">Title</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control"
                                               id="refTitle"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameInput"
                                           class="col-sm-2 control-label">Author</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control"
                                               id="refAuthor"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameInput"
                                           class="col-sm-2 control-label">Date</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control"
                                               id="refDate"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameInput"
                                           class="col-sm-2 control-label">Journal</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control"
                                               id="refJournal"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameInput"
                                           class="col-sm-2 control-label">Pages</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control"
                                               id="refPages"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameInput"
                                           class="col-sm-2 control-label">Link</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control"
                                               id="refLink"/>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="automatically">
                                <div class="form-group"
                                     style="border-bottom:1px solid #CCC;padding-top:20px;padding-bottom:20px;margin-bottom:20px;">
                                    <lable class="control-label col-md-2">
                                        DOI :
                                    </lable>
                                    <div class="input-group col-md-10">
                                        <input id="doi_searchBox" type="text"
                                               class="form-control">
                                        <span class="input-group-btn">
                                            <button id="doiSearch"
                                                    class="btn btn-default"
                                                    type="button">Search</button>
                                        </span>
                                    </div>
                                </div>
                                <div id="doiDetails" style="display:none">
                                    <div class="form-group">
                                        <lable class="control-label col-md-2">Title</lable>
                                        <div class="col-md-10">
                                            <textarea id="doiTitle" class="form-control" style="width:100%;"
                                                      readonly></textarea>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameInput"
                                               class="col-sm-2 control-label">Author</label>
                                        <div class="col-sm-10">
                                            <textarea id="doiAuthor" class="form-control" style="width:100%;"
                                                      readonly></textarea>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameInput"
                                               class="col-sm-2 control-label">Date</label>
                                        <div class="col-sm-10">
                                            <input type="text" class="form-control"
                                                   id="doiDate" readonly/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameInput"
                                               class="col-sm-2 control-label">Journal</label>
                                        <div class="col-sm-10">
                                            <input type="text" class="form-control"
                                                   id="doiJournal" readonly/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameInput"
                                               class="col-sm-2 control-label">Pages</label>
                                        <div class="col-sm-10">
                                            <input type="text" class="form-control"
                                                   id="doiPages" readonly/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameInput"
                                               class="col-sm-2 control-label">Link</label>
                                        <div class="col-sm-10">
                                            <input type="text" class="form-control"
                                                   id="doiLink" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <div class="modal-footer">
                <a href="#">
                    <button id="modal_save" type="button" class="btn btn-success" style="font-size:15px">
                        Save
                    </button>
                    <button id="modal_cancel" type="button" class="btn btn-default" data-dismiss="modal"
                            style="font-size:15px">
                        Cancel
                    </button>
                </a>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
</body>

<script src="../static/js/common/jquery-3.3.1.min.js"></script>
<script src="../static/js/common/bootstrap.min.js"></script>

<script type="text/javascript" src="../static/js/common/bootstrap-treeview.js"></script>
<script type="text/javascript" src="../static/js/common/jquery-steps.js"></script>
<script type="text/javascript" src="../static/js/common/jquery.tag-editor.js"></script>
<script type="text/javascript" src="../static/js/common/pageEn.js"></script>
<script type="text/javascript" src="../static/js/tinymce/tinymce.min.js"></script>
<script type="text/javascript" src="../static/data-tables/jquery.dataTables.js"></script>
<script type="text/javascript" src="../static/data-tables/DT_bootstrap.js"></script>


<script>
    $(document).ready(function () {

        var oid = window.sessionStorage.getItem("editModelItem_id");
        var tree = [];

        var parentNodes = [];
        var parentNodeIds = new Array();

        if ((oid === "0") || (oid === "") || (oid === null)) {

            tinymce.init({
                selector: "textarea#myText",
                height: 300,
                theme: 'modern',
                plugins: ['link', 'table', 'image', 'media'],
                image_title: true,
                // enable automatic uploads of images represented by blob or data URIs
                automatic_uploads: true,
                // URL of our upload handler (for more details check: https://www.tinymce.com/docs/configure/file-image-upload/#images_upload_url)
                // images_upload_url: 'postAcceptor.php',
                // here we add custom filepicker only to Image dialog
                file_picker_types: 'image',

                file_picker_callback: function (cb, value, meta) {
                    var input = document.createElement('input');
                    input.setAttribute('type', 'file');
                    input.setAttribute('accept', 'image/*');
                    input.onchange = function () {
                        var file = input.files[0];

                        var reader = new FileReader();
                        reader.readAsDataURL(file);
                        reader.onload = function () {
                            var img = reader.result.toString();
                            cb(img, {title: file.name});
                        }
                    };
                    input.click();
                },
                images_dataimg_filter: function (img) {
                    return img.hasAttribute('internal-blob');
                }
            });
        }
        else {
            $.ajax({
                url: "/modelItem/getInfo/" + oid,
                type: "get",
                data: {},

                success: (result) => {
                    console.log(result)
                    var basicInfo = result.data;
                    parentNodeIds = basicInfo.classifications;
                    // if(Array.isArray(basicInfo.parentName)){
                    //     parentNodes=basicInfo.parentName;
                    // }
                    // else {
                    //     parentNodes.push(basicInfo.parentName);
                    // }

                    //$("#parentNode").attr("pid", basicInfo.parentIds[0]);
                    //$("#parentNode").val(basicInfo.parentName);
                    $("#nameInput").val(basicInfo.name);
                    $("#descInput").val(basicInfo.description);
                    //tags
                    $('#tagInput').tagEditor('destroy');
                    $('#tagInput').tagEditor({
                        initialTags: basicInfo.keywords,
                        forceLowercase: false,
                        placeholder: 'Enter keywords ...'
                    });
                    //image
                    if (basicInfo.image != "") {
                        $("#imgShow").attr("src", basicInfo.image);
                        $('#imgShow').show();
                    }
                    //reference
                    for (i = 0; i < basicInfo.references.length; i++) {
                        var ref = basicInfo.references[i];
                        table.row.add([
                            ref.title,
                            ref.author,
                            ref.date,
                            ref.journal,
                            ref.pages,
                            ref.links,
                            "<center><a href='javascript:;' class='fa fa-times refClose' style='color:red'></a></center>"]).draw();
                    }
                    if (basicInfo.references.length > 0) {
                        $("#dynamic-table").css("display", "block")
                    }

                    //detail
                    tinymce.remove("textarea#myText");
                    $("#myText").html(basicInfo.detail);
                    tinymce.init({
                        selector: "textarea#myText",
                        height: 500,
                        theme: 'modern',
                        plugins: ['link', 'table', 'image', 'media'],
                        image_title: true,
                        // enable automatic uploads of images represented by blob or data URIs
                        automatic_uploads: true,
                        // URL of our upload handler (for more details check: https://www.tinymce.com/docs/configure/file-image-upload/#images_upload_url)
                        // images_upload_url: 'postAcceptor.php',
                        // here we add custom filepicker only to Image dialog
                        file_picker_types: 'image',

                        file_picker_callback: function (cb, value, meta) {
                            var input = document.createElement('input');
                            input.setAttribute('type', 'file');
                            input.setAttribute('accept', 'image/*');
                            input.onchange = function () {
                                var file = input.files[0];

                                var reader = new FileReader();
                                reader.readAsDataURL(file);
                                reader.onload = function () {
                                    var img = reader.result.toString();
                                    cb(img, {title: file.name});
                                }
                            };
                            input.click();
                        },
                        images_dataimg_filter: function (img) {
                            return img.hasAttribute('internal-blob');
                        }
                    });

                }
            })
            window.sessionStorage.setItem("editModelItem_id", "");
        }
        $("#step").steps({
            onFinish: function () {
                alert('Wizard Completed');
            }
        });


        $('#tagInput').tagEditor({
            forceLowercase: false
        });
        $("#refAuthor").tagEditor({
            forceLowercase: false
        })

        $("#imgChange").click(function () {
            $("#imgFile").click();
        });
        $("#imgFile").change(function () {
            //èŽ·å–input fileçš„filesæ–‡ä»¶æ•°ç»„;
            //$('#filed')èŽ·å–çš„æ˜¯jQueryå¯¹è±¡ï¼Œ.get(0)è½¬ä¸ºåŽŸç”Ÿå¯¹è±¡;
            //è¿™è¾¹é»˜è®¤åªèƒ½é€‰ä¸€ä¸ªï¼Œä½†æ˜¯å­˜æ”¾å½¢å¼ä»ç„¶æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥å–ç¬¬ä¸€ä¸ªå…ƒç´ ä½¿ç”¨[0];
            var file = $('#imgFile').get(0).files[0];
            //åˆ›å»ºç”¨æ¥è¯»å–æ­¤æ–‡ä»¶çš„å¯¹è±¡
            var reader = new FileReader();
            //ä½¿ç”¨è¯¥å¯¹è±¡è¯»å–fileæ–‡ä»¶
            reader.readAsDataURL(file);
            //è¯»å–æ–‡ä»¶æˆåŠŸåŽæ‰§è¡Œçš„æ–¹æ³•å‡½æ•°
            reader.onload = function (e) {
                //è¯»å–æˆåŠŸåŽè¿”å›žçš„ä¸€ä¸ªå‚æ•°eï¼Œæ•´ä¸ªçš„ä¸€ä¸ªè¿›åº¦äº‹ä»¶
                //é€‰æ‹©æ‰€è¦æ˜¾ç¤ºå›¾ç‰‡çš„imgï¼Œè¦èµ‹å€¼ç»™imgçš„srcå°±æ˜¯eä¸­targetä¸‹resulté‡Œé¢
                //çš„base64ç¼–ç æ ¼å¼çš„åœ°å€
                $('#imgShow').get(0).src = e.target.result;
                $('#imgShow').show();
            }
        });


    });
</script>
<script src="../static/js/common/bootstrap-select.js"></script>
<script src="../static/element-ui/index.js"></script>
<script src="../static/js/page/create-modelitem.js"></script>

</html>